SELECT
    A.NewStateID AS IdStato,
    GROUP_CONCAT(A.AppliedRuleID) AS RegoleApplicate
FROM MIU_RuleApplications AS A
GROUP BY A.NewStateID;


-- Questa query unisce le informazioni sugli stati e sulle regole applicate
-- con la descrizione di ciascuna regola dalla tabella RegoleMIU.

SELECT
    A.NewStateID AS IdStato,
    GROUP_CONCAT(R.Descrizione) AS RegoleApplicate
FROM MIU_RuleApplications AS A
JOIN RegoleMIU AS R
  ON A.AppliedRuleID = R.ID
GROUP BY
    A.NewStateID;

-- Questa query unisce le informazioni sugli stati e sulle regole applicate
-- con la descrizione di ciascuna regola dalla tabella RegoleMIU.
-- Inoltre, include il contenuto testuale di ogni stato dalla tabella MIU_States.

-- Questa query unisce le informazioni sugli stati e sulle regole applicate
-- con la descrizione di ciascuna regola dalla tabella RegoleMIU.
-- Inoltre, include il contenuto testuale di ogni stato dalla tabella MIU_States_History.

SELECT
    A.NewStateID AS IdStato,
    H.MIUString AS ContenutoStato,
    GROUP_CONCAT(R.Descrizione) AS RegoleApplicate
FROM MIU_RuleApplications AS A
JOIN RegoleMIU AS R
  ON A.AppliedRuleID = R.ID
JOIN MIU_States_History AS H
  ON A.NewStateID = H.Id
GROUP BY
    A.NewStateID;


-- Ora la query si basa sulla tabella corretta e sulla sua colonna 'Descrizione'.

-- Questa query unisce le informazioni sugli stati, le regole applicate
-- e i percorsi che portano a ciascun stato.

SELECT
    A.NewStateID AS IdStato,
    H.MIUString AS ContenutoStato,
    GROUP_CONCAT(R.Descrizione) AS RegoleApplicate,
    P.PathStepID,
    P.StepNumber,
    P.ParentStateID,
    P.AppliedRuleID,
    P.IsTarget,
    P.IsSuccess
FROM MIU_RuleApplications AS A
JOIN RegoleMIU AS R
  ON A.AppliedRuleID = R.ID
JOIN MIU_States_History AS H
  ON A.NewStateID = H.Id
LEFT JOIN MIU_Paths AS P
  ON A.NewStateID = P.StateID
GROUP BY
    A.NewStateID, P.PathStepID
ORDER BY
    P.StepNumber;

-- L'ordine per StepNumber ci aiuter√† a visualizzare l'evoluzione del percorso.
-- Il raggruppamento per PathStepID ci assicura di vedere ogni singolo passaggio nel percorso.

